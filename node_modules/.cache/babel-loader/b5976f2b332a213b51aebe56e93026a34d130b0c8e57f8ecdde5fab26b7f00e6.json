{"ast":null,"code":"// Configuración de la API\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000';\n\n// Tipos de datos\n\n// Servicio de API\nexport const apiService = {\n  // Convertir URL relativa a absoluta\n  getAbsoluteUrl(url) {\n    if (url.startsWith('http://') || url.startsWith('https://')) {\n      return url;\n    }\n    return `${API_BASE_URL}${url}`;\n  },\n  // Health check\n  async healthCheck() {\n    try {\n      const response = await fetch(`${API_BASE_URL}/health`);\n      if (!response.ok) throw new Error('Health check failed');\n      return await response.json();\n    } catch (error) {\n      console.error('Error en health check:', error);\n      throw error;\n    }\n  },\n  // Búsqueda de fotos similares en el marketplace\n  async searchSimilarPhotos(imageFile) {\n    try {\n      const formData = new FormData();\n      formData.append('selfie', imageFile);\n      const response = await fetch(`${API_BASE_URL}/marketplace/search-similar`, {\n        method: 'POST',\n        body: formData\n      });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.detail || 'Error en la búsqueda');\n      }\n      const data = await response.json();\n\n      // Convertir URLs relativas a absolutas\n      const photosWithAbsoluteUrls = (data.photos || []).map(photo => ({\n        ...photo,\n        thumbnail: this.getAbsoluteUrl(photo.thumbnail),\n        image: this.getAbsoluteUrl(photo.image)\n      }));\n      const matchesWithAbsoluteUrls = (data.matches || []).map(photo => ({\n        ...photo,\n        thumbnail: this.getAbsoluteUrl(photo.thumbnail),\n        image: this.getAbsoluteUrl(photo.image)\n      }));\n      return {\n        ...data,\n        photos: photosWithAbsoluteUrls,\n        matches: matchesWithAbsoluteUrls\n      };\n    } catch (error) {\n      console.error('Error buscando fotos similares:', error);\n      throw error;\n    }\n  },\n  // Obtener todas las fotos del marketplace\n  async getMarketplacePhotos() {\n    try {\n      const response = await fetch(`${API_BASE_URL}/marketplace/photos`);\n      if (!response.ok) throw new Error('Error obteniendo fotos');\n      const data = await response.json();\n\n      // Convertir URLs relativas a absolutas\n      const photosWithAbsoluteUrls = (data.photos || []).map(photo => ({\n        ...photo,\n        thumbnail: this.getAbsoluteUrl(photo.thumbnail),\n        image: this.getAbsoluteUrl(photo.image)\n      }));\n      return photosWithAbsoluteUrls;\n    } catch (error) {\n      console.error('Error obteniendo fotos del marketplace:', error);\n      throw error;\n    }\n  },\n  // Obtener filtros disponibles\n  async getMarketplaceFilters() {\n    try {\n      const response = await fetch(`${API_BASE_URL}/marketplace/filters`);\n      if (!response.ok) throw new Error('Error obteniendo filtros');\n      return await response.json();\n    } catch (error) {\n      console.error('Error obteniendo filtros:', error);\n      throw error;\n    }\n  },\n  // Obtener preview de una foto\n  getPhotoPreviewUrl(folderName, filename, watermark = true) {\n    return `${API_BASE_URL}/photos/preview?folder_name=${folderName}&filename=${filename}&watermark=${watermark}`;\n  },\n  // Obtener foto original\n  getPhotoViewUrl(folderName, filename) {\n    return `${API_BASE_URL}/photos/view?folder_name=${folderName}&filename=${filename}`;\n  },\n  // Obtener carpetas (folders)\n  async getFolders() {\n    try {\n      const response = await fetch(`${API_BASE_URL}/folders`);\n      if (!response.ok) throw new Error('Error obteniendo carpetas');\n      const data = await response.json();\n      return data.folders || [];\n    } catch (error) {\n      console.error('Error obteniendo carpetas:', error);\n      throw error;\n    }\n  }\n};\nexport default apiService;","map":{"version":3,"names":["API_BASE_URL","process","env","REACT_APP_API_URL","apiService","getAbsoluteUrl","url","startsWith","healthCheck","response","fetch","ok","Error","json","error","console","searchSimilarPhotos","imageFile","formData","FormData","append","method","body","detail","data","photosWithAbsoluteUrls","photos","map","photo","thumbnail","image","matchesWithAbsoluteUrls","matches","getMarketplacePhotos","getMarketplaceFilters","getPhotoPreviewUrl","folderName","filename","watermark","getPhotoViewUrl","getFolders","folders"],"sources":["/Users/axelhernandez/Surf/frontend/src/services/api.ts"],"sourcesContent":["// Configuración de la API\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000';\n\n// Tipos de datos\nexport interface Photo {\n  id: string;\n  filename: string;\n  school: string;\n  date: string;\n  similarity?: number;\n  thumbnail: string;\n  image: string;\n  price?: number;\n}\n\nexport interface SearchResult {\n  status: string;\n  photos: Photo[];\n  matches: Photo[];\n  matches_count: number;\n  total_photos: number;\n  threshold_used: number;\n}\n\nexport interface HealthCheckResponse {\n  status: string;\n  message: string;\n  model: string;\n  model_loaded: boolean;\n}\n\n// Servicio de API\nexport const apiService = {\n  // Convertir URL relativa a absoluta\n  getAbsoluteUrl(url: string): string {\n    if (url.startsWith('http://') || url.startsWith('https://')) {\n      return url;\n    }\n    return `${API_BASE_URL}${url}`;\n  },\n\n  // Health check\n  async healthCheck(): Promise<HealthCheckResponse> {\n    try {\n      const response = await fetch(`${API_BASE_URL}/health`);\n      if (!response.ok) throw new Error('Health check failed');\n      return await response.json();\n    } catch (error) {\n      console.error('Error en health check:', error);\n      throw error;\n    }\n  },\n\n  // Búsqueda de fotos similares en el marketplace\n  async searchSimilarPhotos(imageFile: File): Promise<SearchResult> {\n    try {\n      const formData = new FormData();\n      formData.append('selfie', imageFile);\n\n      const response = await fetch(`${API_BASE_URL}/marketplace/search-similar`, {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.detail || 'Error en la búsqueda');\n      }\n\n      const data = await response.json();\n      \n      // Convertir URLs relativas a absolutas\n      const photosWithAbsoluteUrls = (data.photos || []).map((photo: Photo) => ({\n        ...photo,\n        thumbnail: this.getAbsoluteUrl(photo.thumbnail),\n        image: this.getAbsoluteUrl(photo.image),\n      }));\n      \n      const matchesWithAbsoluteUrls = (data.matches || []).map((photo: Photo) => ({\n        ...photo,\n        thumbnail: this.getAbsoluteUrl(photo.thumbnail),\n        image: this.getAbsoluteUrl(photo.image),\n      }));\n      \n      return {\n        ...data,\n        photos: photosWithAbsoluteUrls,\n        matches: matchesWithAbsoluteUrls,\n      };\n    } catch (error) {\n      console.error('Error buscando fotos similares:', error);\n      throw error;\n    }\n  },\n\n  // Obtener todas las fotos del marketplace\n  async getMarketplacePhotos(): Promise<Photo[]> {\n    try {\n      const response = await fetch(`${API_BASE_URL}/marketplace/photos`);\n      if (!response.ok) throw new Error('Error obteniendo fotos');\n      const data = await response.json();\n      \n      // Convertir URLs relativas a absolutas\n      const photosWithAbsoluteUrls = (data.photos || []).map((photo: Photo) => ({\n        ...photo,\n        thumbnail: this.getAbsoluteUrl(photo.thumbnail),\n        image: this.getAbsoluteUrl(photo.image),\n      }));\n      \n      return photosWithAbsoluteUrls;\n    } catch (error) {\n      console.error('Error obteniendo fotos del marketplace:', error);\n      throw error;\n    }\n  },\n\n  // Obtener filtros disponibles\n  async getMarketplaceFilters() {\n    try {\n      const response = await fetch(`${API_BASE_URL}/marketplace/filters`);\n      if (!response.ok) throw new Error('Error obteniendo filtros');\n      return await response.json();\n    } catch (error) {\n      console.error('Error obteniendo filtros:', error);\n      throw error;\n    }\n  },\n\n  // Obtener preview de una foto\n  getPhotoPreviewUrl(folderName: string, filename: string, watermark: boolean = true): string {\n    return `${API_BASE_URL}/photos/preview?folder_name=${folderName}&filename=${filename}&watermark=${watermark}`;\n  },\n\n  // Obtener foto original\n  getPhotoViewUrl(folderName: string, filename: string): string {\n    return `${API_BASE_URL}/photos/view?folder_name=${folderName}&filename=${filename}`;\n  },\n\n  // Obtener carpetas (folders)\n  async getFolders(): Promise<any[]> {\n    try {\n      const response = await fetch(`${API_BASE_URL}/folders`);\n      if (!response.ok) throw new Error('Error obteniendo carpetas');\n      const data = await response.json();\n      return data.folders || [];\n    } catch (error) {\n      console.error('Error obteniendo carpetas:', error);\n      throw error;\n    }\n  },\n};\n\nexport default apiService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}